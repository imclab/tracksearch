<!DOCTYPE html>
<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>Download VTT files</title>

</head>

<body>

<div id="data"></div>

<!-- // http://img.youtube.com/vi/3pxf3Ju2row/hqdefault.jpg -->

<script type="text/javascript">
var videos = {};
var videoIds = ["PPXeWjWp-8Y", "gkb_x9ZN0Vo", "nv0F0k6iDB8", "peo0DZZWS10", "LQms5F3ZlcU", "urGK3ZZ8Rs0", "9ZcAsZq468Y", "Ervh-vrTBOw", "5KL_ccQwAuo", "JyHXtviaTBQ", "FvYxf8b3_BQ", "ogumRA9LxR4", "vHowRlkImzk", "8yfCQtx_nIE", "tiXXeAkywrM", "-wumTIhaKYc", "ktwJ-EDiZoU", "lYk6oc9w8PY", "iDiulvWRcZs", "8b0LCBx8Rys", "OXQsZSWBDDM", "nn0_fQYQ2Qk", "K7sG1dRSn4c", "_O3-20FUJbg", "4cIFRn0rp5s", "iH4D2LiKbXg", "tmzxMO9lrF0", "FmsLJHikRf8", "-Gs1SPZnmrA", "JeR506RJQjQ", "NG42lu-GEbo", "y_1M0ilLoZU", "dAhhniqwkp8", "VYtW5K8Lbhg", "ZV_BIGmpfF8", "6Nb65wOWoT8", "1rs9jj7fYxU", "7lDQhxZII6c", "Jm5rVSevb7E", "ayhDAWp16eg", "pmqKnEG-6GA", "ZwFQcKD320w", "nb4gvrNrDWw", "zH5bJSG0DZk", "bnK3XKOVgwQ", "R281PhQufHo", "XAqIpGU8ZZk", "anSdHAFLOPM", "7sad-UGSOXE", "SGcbzTKRXlc", "soupCDgrREY", "4EHKN1ywdb4", "s4zpL4VBbuU", "g3aBfkFbPWk", "J7Q0a_Fz1Kg", "HK2rSAe_HLA", "UUnC5y4j0As", "4mf_yNLlgic", "rT-BxYLZdeY", "7os4DImjK5U", "yd30Nmb3mPU", "q_O9_C2ZjoA", "nOEw9iiopwI", "TcaWEk2O3CM", "ith5K5mWr_g", "WP3N1bgjiek", "vnXb1S6l_jE", "uGTm6_KbG-g", "Fja-TCLWpUc", "6dfrfRl6il8", "nP8Mo0jGQDk", "wRDPTnY3yO8", "ZNiB7kcPqhE", "ATJjbFkxRcc", "XMYVSIUfu2I", "4kGeyMkhFdQ", "mQpo22NN438", "4W7c9g--yBY", "gGVkVQN63Yc", "hGc4XBc9P9c", "nK5VZ71qMIY", "rNkfs8-uRTE", "BZeQETah684", "bmxr75CV36A", "e3McMaHvlBY", "laLudeUmXHM", "IP0nMv_NI1s", "B4M_a7xejYI", "07HaQwxAo5s", "DO-nzPqhdXw", "Gn_jlvkHTnM", "Sn_3rJaexKc", "VIBOCVY0Hvg", "ZhDb42M6ZLk", "WsvNebq1dRg", "QND2lFCrIGw", "A0Z0ybTCHKs", "IiN9fxwjcL0", "f5lYNV7eDd8"];

function getVideoData(videoId){
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "http://gdata.youtube.com/feeds/api/videos/" + videoId +"?alt=json");
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4 && xhr.status === 200) {
        var obj = JSON.parse(xhr.responseText);
        var content = obj.entry.content.$t;
        var video = {};
        video.summary = content;
        // video.speakers = content.split(/[\n\n|\r\n\r\n]/)[0];
        // // video.subtitle = content[1];
        // // video.description = content[2];
        video.viewCount = obj.entry.yt$statistics.viewCount;
        try{
            video.rating = obj.entry.gd$rating.average;
        } catch(e) {
            console.log(obj.entry);
        }
        video.title = obj.entry.title.$t;
        video.id = videoId;
        videos[videoId] = video;
        if (videoId === "f5lYNV7eDd8"){ // hack: last one
            console.log(videos);
            document.getElementById("data").innerHTML = JSON.stringify(videos);
            var keys = Object.keys(videos);
            for (var i = 0; i != videoIds.length; ++i){
                var id = videoIds[i];
                if (keys.indexOf(id) === -1){
                    console.log(id);
                }
            }
        }
      }
    }

    xhr.send();
}

for (var i = 0; i != videoIds.length; ++i){
    getVideoData(videoIds[i]);
}

// var newVideos = {};
// for (var i = 0; i != videos.length; ++i){
//     var video = videos[i];
//     newVideos[video.id] = {content: video.content, rating: video.rating, speakers: video.speakers, title: video.title, viewCount: video.viewCount};

// }
// document.getElementById("data").innerHTML = JSON.stringify(newVideos);
</script>



</body>

</html>
